# generate-visuals

## Description
Creates executive-facing visual artifacts using Canva (presentations) and Figma (design annotations). Transforms Strategy findings into polished visual deliverables for leadership review.

## Trigger
This skill is invoked automatically when the `executive-briefing` command runs, or when the command center agent determines executive-level visual output is needed.

## Instructions

### 1. Accept Input
Receive the synthesized LOB findings and executive summary data.

### 2. Load Templates
Read the Canva and Figma templates from `references/tool-templates.json`.

### 3. Create Canva Presentation

Use the Canva MCP server to create an executive briefing presentation:

**Slide Structure** (from template):

1. **Title Slide**
   - "Strategy Intelligence Briefing"
   - Date
   - "Generated by Strategy Command Center"

2. **Executive Summary Slide**
   - Dashboards analyzed count
   - Critical / Warning / Informational finding counts
   - Overall health status indicator
   - Cross-LOB themes (if any)

3. **LOB Finding Slides** (one per LOB with findings)
   - LOB name and finding count
   - Key findings listed by severity
   - Key metric highlight with trend direction
   - Dashboard reference

4. **Recommendations Slide**
   - Prioritized action items across all LOBs
   - Sorted by severity (critical first)
   - Each with assigned LOB owner and suggested timeline

5. **Appendix Slide** (optional)
   - Dashboard URLs for reference
   - External source links
   - Data freshness timestamp

### 4. Add Figma Annotations

If Figma design files are relevant to the findings (e.g., product dashboards, UX metrics):

Use the Figma MCP server to add comments on relevant design files:
- **Comment text** (from template): Include severity icon, finding title, metric, source dashboard, and recommendation
- Place comments on the relevant frames or components
- Tag relevant team members if configured

### 5. Return Results

```json
{
  "generated_at": "ISO-8601 timestamp",
  "canva_presentation_url": "...",
  "canva_slide_count": 0,
  "figma_comments_added": 0,
  "figma_file_ids": [],
  "errors": []
}
```

## Error Handling
- If Canva MCP is unavailable, generate the presentation content as formatted Markdown for manual creation
- If Figma MCP is unavailable, skip annotations and note in the output
- Visual generation is non-blocking â€” failures here should not prevent other routing skills from completing
